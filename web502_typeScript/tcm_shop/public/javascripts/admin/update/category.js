(()=>{"use strict";var t,e=function(t){return function(e){console.log(t,e)}},n=function(t,e){console.log("Main Class: ",t,"Selected Property: ",e)},a=function(t,e,n){console.log("Main Class: ",t,"Selected Method: ",e,"Method Descriptor: ",n)},o=function(t,e,n,a){var o,r=arguments.length,i=r<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,a);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(r<3?o(i):r>3?o(e,n,i):o(e,n))||i);return r>3&&i&&Object.defineProperty(e,n,i),i},r=function(){function t(t,e,n,a){this.selectElement=t,this.activeClass=e,this.selectOptionContainer=n,this.attributeList=a}return t.prototype.addOptionItem=function(t,e){void 0===e&&(e=[{key:String(),data:String()}]);var n=document.createElement("li");e.forEach((function(t){n.setAttribute(t.key,t.data)})),n.innerText=t,this.selectOptionContainer.appendChild(n)},t.prototype.createLabelPointer=function(t){var e=this;t.addEventListener("click",(function(){e.selectElement.focus()}))},t.prototype.createCustomSelect=function(t,e,n){var a=this;this.selectElement.setAttribute("tabindex","0");var o,r,i=function(t){t?a.selectElement.classList.add(a.activeClass):a.selectElement.classList.remove(a.activeClass)},c=function(t){s.forEach((function(t){t.removeAttribute(n)})),t.setAttribute(n,"")},s=this.selectElement.querySelectorAll("li"),u=0;a.selectElement.addEventListener("focus",(function(){i(!0),c(s[u])})),a.selectElement.addEventListener("focusout",(function(){i(!1)})),a.selectElement.addEventListener("mouseenter",(function(){i(!0),c(s[u])})),a.selectElement.addEventListener("mouseleave",(function(){i(!1)})),a.selectElement.addEventListener("click",(function(){i(o),o=!0})),a.selectElement.addEventListener("keydown",(function(t){"ArrowDown"===t.key?(u<s.length-1?u++:u=0,c(s[u])):"ArrowUp"===t.key?(u>0?u--:u=s.length-1,c(s[u])):"Enter"===t.key&&(a.selectElement.classList.contains(a.activeClass)?s[u].click():i(!0))})),r=function(t){a.attributeList.forEach((function(e){a.selectElement.setAttribute(e,t.getAttribute(e))})),e.innerHTML=t.innerHTML,o=!1},s.forEach((function(e,n){e.getAttribute("value")===t&&(r(e),o=!0,u=n,c(e)),e.addEventListener("click",(function(){r(e),u=n,c(e),i(!1)})),e.addEventListener("mouseenter",(function(){c(e)}))}))},o([n],t.prototype,"selectElement",void 0),o([n],t.prototype,"activeClass",void 0),o([n],t.prototype,"selectOptionContainer",void 0),o([n],t.prototype,"attributeList",void 0),o([a],t.prototype,"addOptionItem",null),o([a],t.prototype,"createLabelPointer",null),o([a],t.prototype,"createCustomSelect",null),o([e("Custom Select Creator")],t)}(),i=(t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}),c=function(t,e,n,a){var o,r=arguments.length,i=r<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,a);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(r<3?o(i):r>3?o(e,n,i):o(e,n))||i);return r>3&&i&&Object.defineProperty(e,n,i),i},s=function(t,e){this.fetchLink=t,this.fetchMethod=e},u=function(t){function n(e){return t.call(this,"".concat(e,".json"),"GET")||this}return i(n,t),n.prototype.readData=function(t){fetch(this.fetchLink,{method:this.fetchMethod}).then((function(t){if(!t.ok)throw new Error("Error = "+t.status);return t.json()})).then((function(e){t(e)})).catch((function(t){console.log("error: "+t)}))},c([a],n.prototype,"readData",null),c([e("Data Reader")],n)}(s),l=(function(t){function n(e){return t.call(this,e,"DELETE")||this}i(n,t),n.prototype.deleteData=function(t,e){var n="".concat(this.fetchLink,"/").concat(t,".json");fetch(n,{method:this.fetchMethod}).then((function(t){if(!t.ok)throw new Error("error = "+t.status);return t.json()})).then((function(t){e(t)})).catch((function(t){console.log("error: "+t)}))},c([a],n.prototype,"deleteData",null),n=c([e("Data Deleter")],n)}(s),function(t){function n(e){return t.call(this,e,"POST")||this}i(n,t),n.prototype.addData=function(t,e,n){fetch("".concat(this.fetchLink,".json"),{method:this.fetchMethod,body:t}).then((function(t){if(!t.ok)throw n(),new Error("error = "+t.status);return t.json()})).then((function(){e()})).catch((function(t){console.log("error: "+t)}))},c([a],n.prototype,"addData",null),n=c([e("Data Adder")],n)}(s),function(t){function n(e){return t.call(this,e,"PUT")||this}return i(n,t),n.prototype.updateData=function(t,e,n,a){fetch("".concat(this.fetchLink+t,".json"),{method:this.fetchMethod,body:JSON.stringify(e)}).then((function(t){if(!t.ok)throw a(),new Error("error = "+t.status);return t.json()})).then((function(){n()})).catch((function(t){console.log("error: "+t)}))},c([a],n.prototype,"updateData",null),c([e("Data Updater")],n)}(s)),d=function(t,e,n,a){var o,r=arguments.length,i=r<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,a);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(r<3?o(i):r>3?o(e,n,i):o(e,n))||i);return r>3&&i&&Object.defineProperty(e,n,i),i},p=function(){function t(t,e,n,a){this.submitButton=t,this.hideMessageContainerClass=e,this.inputInvalidClass=n,this.inputValidClass=a,this.inputList=[],this.checkValidate=!1}return t.prototype.changeInputStatus=function(t,e,n){!0===n?(e.classList.add(this.hideMessageContainerClass),t.classList.remove(this.inputInvalidClass),t.classList.add(this.inputValidClass)):!1===n&&(e.classList.remove(this.hideMessageContainerClass),t.classList.remove(this.inputValidClass),t.classList.add(this.inputInvalidClass))},t.prototype.changeButtonStatus=function(){var t=this;this.checkValidate=!0,this.inputList.forEach((function(e){!1===e.classList.contains(t.inputValidClass)&&(t.checkValidate=!1)})),!0===this.checkValidate?this.submitButton.removeAttribute("disabled"):this.submitButton.setAttribute("disabled","")},t.prototype.addTextInputValidator=function(t,e,n,a,o,r,i){var c=this;this.inputList.push(t),t.addEventListener("change",(function(){t.value=t.value.trim();var s=t.value,u=!1;s.length<a?(n.innerHTML="The ".concat(e," must have more than ").concat(a," "),n.innerHTML+=1===a?"character":"characters"):s.length>o?(n.innerHTML="The ".concat(e," must have less than ").concat(o," "),n.innerHTML+=1===o?"character":"characters"):!1===r.test(s)?n.innerHTML=i:u=!0,c.changeInputStatus(t,n,u),c.changeButtonStatus()}))},t.prototype.addNumberInputValidator=function(t,e,n,a,o,r){var i=this;this.inputList.push(t),t.addEventListener("input",(function(){var c=Number(t.value),s=!1;isNaN(c)||""===t.value?n.innerHTML="The ".concat(e," must be a number"):c<a?n.innerHTML="The ".concat(e," must greater than ").concat(a):c>o?n.innerHTML="The ".concat(e," must lesser than ").concat(o):c/r%1!=0?n.innerHTML="The ".concat(e," step must be ").concat(r):s=!0,i.changeInputStatus(t,n,s),i.changeButtonStatus()}))},t.prototype.addFileInputValidator=function(t,e,n,a,o,r){var i=this;this.inputList.push(t);var c=1048576;t.addEventListener("change",(function(s){var u=!1,l=s.target.files[0],d=l.type,p=!1;if(a.forEach((function(t){d===t&&(p=!0)})),!1===p){var f="The ".concat(e," file extension must be a value in the list:");a.forEach((function(t){f+=" ".concat(t.split("/").pop().toUpperCase(),",")})),n.innerHTML=f.slice(0,-2)}else l.size<o*c?n.innerHTML="The ".concat(e," file size must greater than ").concat(o," MB"):l.size>r*c?n.innerHTML="The ".concat(e," file size must lesser than ").concat(r," MB"):u=!0;i.changeInputStatus(t,n,u),i.changeButtonStatus()}))},t.prototype.addDateInputValidator=function(t,e,n,a,o){var r=this;void 0===a&&(a={day:Number(),month:Number(),year:Number()}),void 0===o&&(o={day:Number(),month:Number(),year:Number()}),this.inputList.push(t);var i=new Date(a.year,a.month-1,a.day).getTime(),c=new Date(o.year,o.month-1,o.day).getTime(),s=function(){var s=t.value,u=!1;if(""===s)n.innerHTML="The ".concat(e," must be a valid date");else{var l=s.split(/\D/),d=Number(l[0]),p=Number(l[1])-1,f=Number(l[2]),h=new Date(d,p,f).getTime();if(h<i||d<100&&a.year>=100){var y="".concat(a.day,"/").concat(a.month,"/").concat(a.year);n.innerHTML="The ".concat(e," must greater than ").concat(y)}else if(h>c){var v="".concat(o.day,"/").concat(o.month,"/").concat(o.year);n.innerHTML="The ".concat(e," must lesser than ").concat(v)}else u=!0}r.changeInputStatus(t,n,u),r.changeButtonStatus()};t.addEventListener("blur",s),t.addEventListener("keypress",(function(t){"Enter"===t.key&&s()}))},t.prototype.addRetypeInputValidator=function(t,e,n,a,o){var r=this;this.inputList.push(n);var i,c=!1,s=function(){!1==(i=n.value===t.value)&&(o.innerHTML="The ".concat(a," must be like the ").concat(e)),r.changeInputStatus(n,o,i),r.changeButtonStatus()};t.addEventListener("change",(function(){!0===c&&s()})),n.addEventListener("change",(function(){c=!0,s()}))},t.prototype.checkDuplicateValidator=function(t,e,n,a,o,r,i){var c=this;void 0===o&&(o=Boolean()),void 0===r&&(r=Boolean()),void 0===i&&(i=Boolean()),t.setAttribute("data-duplicate",JSON.stringify(a));var s=function(a){var i,s=JSON.parse(t.dataset.duplicate);!0===r&&(a=a.toLowerCase(),s.forEach((function(t,e,n){n[e]=t.toLowerCase()}))),!0===o?(i=!1,s.forEach((function(t){a===t&&(i=!0)}))):!1===o&&(i=!0,s.forEach((function(t){a===t&&(i=!1)}))),!1===i&&!1===o?n.innerHTML="The ".concat(e," is exist"):!1===i&&!0===o&&(n.innerHTML="The ".concat(e," is not exist")),c.changeInputStatus(t,n,i),c.changeButtonStatus()};!1===i?(this.inputList.push(t),t.addEventListener("change",(function(){s(t.value)}))):t.addEventListener("change",(function(){t.classList.contains(c.inputValidClass)&&s(t.value)}))},t.prototype.changeDuplicateValue=function(t,e,n){var a=JSON.parse(t.dataset.duplicate);!0===n?a.push(e):a.splice(a.indexOf(e),1),t.setAttribute("data-duplicate",JSON.stringify(a))},t.prototype.createSubmitButtonEvent=function(t,e){var n=this;!0===e?this.submitButton.setAttribute("disabled","true"):(this.checkValidate=!0,this.inputList.forEach((function(t){t.classList.add(n.inputValidClass)}))),this.submitButton.addEventListener("click",(function(e){e.preventDefault(),!0===n.checkValidate&&t()}))},t.prototype.resetForm=function(t){var e=this;t.reset(),this.inputList.forEach((function(t){t.classList.remove(e.inputValidClass)})),this.changeButtonStatus()},d([n],t.prototype,"submitButton",void 0),d([n],t.prototype,"hideMessageContainerClass",void 0),d([n],t.prototype,"inputInvalidClass",void 0),d([n],t.prototype,"inputValidClass",void 0),d([n],t.prototype,"inputList",void 0),d([n],t.prototype,"checkValidate",void 0),d([a],t.prototype,"changeInputStatus",null),d([a],t.prototype,"changeButtonStatus",null),d([a],t.prototype,"addTextInputValidator",null),d([a],t.prototype,"addNumberInputValidator",null),d([a],t.prototype,"addFileInputValidator",null),d([a],t.prototype,"addDateInputValidator",null),d([a],t.prototype,"addRetypeInputValidator",null),d([a],t.prototype,"checkDuplicateValidator",null),d([a],t.prototype,"changeDuplicateValue",null),d([a],t.prototype,"createSubmitButtonEvent",null),d([a],t.prototype,"resetForm",null),d([e("Form Validator")],t)}(),f=function(t,e,n,a){var o,r=arguments.length,i=r<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,a);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(r<3?o(i):r>3?o(e,n,i):o(e,n))||i);return r>3&&i&&Object.defineProperty(e,n,i),i},h=new(function(){function t(t,e,n,a){this.verticalAlign=t,this.verticalOffset=e,this.horizontalAlign=n,this.horizontalOffset=a}return t.prototype.createToast=function(t,e,n){var a,o=this,r=document.body,i="toast-".concat(t);switch(t){case"success":a='<i class="fa-solid fa-check"></i>';break;case"danger":a='<i class="fa-solid fa-xmark"></i>';break;case"warning":a='<i class="fa-solid fa-exclamation"></i>';break;case"info":a='<i class="fa-solid fa-question"></i>'}var c=document.createElement("div");c.setAttribute("class","toast ".concat(i," js-toastify")),c.innerHTML='\n      <div class="toast-icon">\n        '.concat(a,'\n      </div>\n      <div class="toast-message">\n        ').concat(e,'\n      </div>\n      <div class="toast-close">\n        <i class="fa-solid fa-xmark"></i>\n      </div>\n    ');var s=document.querySelectorAll(".js-toastify"),u=this.verticalOffset;s.length>0&&s.forEach((function(t){u+=o.verticalOffset+t.offsetHeight})),c.setAttribute("style","\n      ".concat(this.horizontalAlign,": ").concat(this.horizontalOffset,"px;\n      ").concat(this.verticalAlign,": ").concat(u,"px;\n    ")),r.appendChild(c);var l=function(){c.style[o.horizontalAlign]="-".concat(c.offsetWidth,"px"),c.style.opacity="0.2",setTimeout((function(){for(var t=c.nextElementSibling;t;){var e=Number(t.style[o.verticalAlign].slice(0,-2));t.style[o.verticalAlign]="".concat(e-c.offsetHeight-o.verticalOffset,"px"),t=t.nextElementSibling}r.removeChild(c)}),200)},d=setTimeout((function(){l()}),1e3*n);c.querySelector(".toast-close").addEventListener("click",(function(){clearTimeout(d),l()}))},f([n],t.prototype,"verticalAlign",void 0),f([n],t.prototype,"verticalOffset",void 0),f([n],t.prototype,"horizontalAlign",void 0),f([n],t.prototype,"horizontalOffset",void 0),f([a],t.prototype,"createToast",null),f([e("Toast Creator")],t)}())("bottom",16,"right",16),y=location.href,v="https://tcm-shop-default-rtdb.firebaseio.com/categories/",m=y.substring(y.lastIndexOf("/")+1),g={form:document.querySelector("#updateCategoryForm"),categoryName:document.querySelector("#categoryName"),categoryOrder:document.querySelector("#categoryOrder"),categoryDisplay:document.querySelector("#categoryDisplay"),submitButton:document.querySelector("#js-update-data-submit")};window.addEventListener("load",(function(){new u(v+m).readData((function(t){var e,n,a,o,i,c;g.categoryName.value=t.CategoryName,g.categoryOrder.value=String(t.CategoryOrder),e=t.CategoryDisplay,a=(n=g.categoryDisplay).querySelector(".custom-select-list"),o=n.querySelector(".custom-select-text"),i=document.querySelectorAll("[for=categoryDisplay]"),c=new r(n,"active",a,["value"]),i.forEach((function(t){c.createLabelPointer(t)})),["Show","Hide"].forEach((function(t){c.addOptionItem(t,[{key:"value",data:t}])})),c.createCustomSelect(e,o,"choosen"),function(t,e,n,a){var o,r,i,c=new p(g.submitButton,"d-none","is-invalid","is-valid");o=g.categoryName.parentElement.parentElement.querySelector(".invalid-feedback"),c.addTextInputValidator(g.categoryName,"category name",o,4,200,/^([A-Za-z0-9]{1})([\w\s'":,.&+|-]{0,199})$/,"Category name must be start with alphanumeric and \n      contains only alphanumeric, underscore or some specials \n      characters include , ' \" : - ; _ + . |"),new u("https://tcm-shop-default-rtdb.firebaseio.com/categories").readData((function(e){var n=function(){var n=[];Object.keys(e).map((function(t){n.push(e[t].CategoryName)}));var a=n.indexOf(t);return n.splice(a,1),n}();c.checkDuplicateValidator(g.categoryName,"category name",o,n,!1,!1,!0)})),r=g.categoryOrder.parentElement.parentElement.querySelector(".invalid-feedback"),c.addNumberInputValidator(g.categoryOrder,"category order",r,1,99,1),i=new l(v),c.createSubmitButtonEvent((function(){if(g.categoryName.value===t&&g.categoryOrder.value===e&&g.categoryDisplay.getAttribute("value")===n)h.createToast("warning","Please change at least one field before updating",2);else{var o=JSON.stringify({CategoryName:g.categoryName.value,CategoryOrder:Number(g.categoryOrder.value),CategoryDisplay:g.categoryDisplay.getAttribute("value"),CategoryProductQuantity:a});i.updateData(m,o,(function(){h.createToast("success","Update category completed \n Category name: ".concat(g.categoryName.value),2);var a,o=t;t=g.categoryName.value,e=g.categoryOrder.value,n=g.categoryDisplay.getAttribute("value");var r=function(){clearTimeout(a),a=setTimeout((function(){h.createToast("success","Update overide products completed - New category name: ".concat(t),2)}),100)},i=function(){clearTimeout(a),a=setTimeout((function(){h.createToast("danger","Update overide products category failed",2)}),100)};!function(t){var e=new u("https://tcm-shop-default-rtdb.firebaseio.com/products"),n=new l("https://tcm-shop-default-rtdb.firebaseio.com/products/");e.readData((function(e){Object.keys(e).map((function(a){e[a].ProductCategory===o&&function(t,e){var a=t+"/ProductCategory",o='"'.concat(e,'"');n.updateData(a,o,r,i)}(a,t)}))}))}(t)}),(function(){h.createToast("danger","Update category failed",2)}))}}),!1)}(t.CategoryName,String(t.CategoryOrder),t.CategoryDisplay,t.CategoryProductQuantity)}))}))})();